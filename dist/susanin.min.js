!function(t){function e(t){return{"./querystring":function(){var t={},e=Object.prototype.hasOwnProperty,r=Object.prototype.toString,n=function(t){return"[object Array]"===r.call(t)},i={decode:function(t){var e;try{e=decodeURIComponent(t.replace(/\+/g,"%20"))}catch(r){e=t}return e},parse:function(t,r,o){var a,s,u,p,f,h,c={};if("string"!=typeof t||""===t)return c;for(r||(r="&"),o||(o="="),a=t.split(r),f=0,h=a.length;h>f;++f)s=a[f].split(o),u="undefined"!=typeof s[1]?i.decode(s[1]):"",p=i.decode(s[0]),e.call(c,p)?n(c[p])?c[p].push(u):c[p]=[c[p],u]:c[p]=u;return c},stringify:function(t,r,n){var i,o,a,s,u,p,f="";if(!t)return f;r||(r="&"),n||(n="=");for(p in t)if(e.call(t,p))for(a=[].concat(t[p]),s=0,u=a.length;u>s;++s)o=typeof a[s],i="object"===o||"undefined"===o?"":encodeURIComponent(a[s]),f+=r+encodeURIComponent(p)+n+i;return f.substr(r.length)}};return t.exports=i,t.exports},"./route":function(){function t(e){if(!(this instanceof t))return new t(e);if("string"==typeof e&&(e={pattern:e}),!e||"object"!=typeof e)throw new Error("You must specify options");if("string"!=typeof e.pattern)throw new Error("You must specify the pattern of the route");this._options=e,this._conditions=e.conditions&&"object"==typeof e.conditions?e.conditions:{},e.isTrailingSlashOptional!==!1&&(e.pattern+=c+f+g+h+l,this._conditions[g]=P),e.pattern+=c+"?"+f+b+h+l,this._conditions[b]=".*",this._paramsMap=[],this._mainParamsMap={},this._requiredParams=[],this._parts=this._parsePattern(e.pattern),this._buildParseRegExp(),this._buildBuildFn()}var r={},n=Object.prototype.hasOwnProperty,i=function(t,e){return n.call(t,e)},o=Object.prototype.toString,a=function(t){return"[object Array]"===o.call(t)},s=e("./querystring"),u=function(){var t=["/",".","*","+","?","|","(",")","[","]","{","}","\\"],e=new RegExp("(\\"+t.join("|\\")+")","g");return function(t){return t.replace(e,"\\$1")}}(),p=String(Math.random()).substr(2,5),f="<",h=">",c="(",l=")",d="[a-zA-Z_][\\w\\-]*",_="[\\w\\-\\.~]+",m=new RegExp("("+u(f)+d+u(h)+"|"+"[^"+u(f)+u(h)+"]+"+"|"+u(f)+"|"+u(h)+")","g"),g="ts_"+p,y="/",P=u("/"),b="qs_"+p;return t.prototype._parsePattern=function(t,e){for(var r,n,i,o=[],a="",s=0,u=0,p=!1,f=t.length;f>s;)if(r=t.charAt(s++),r===c)p?(++u,a+=r):(this._parseParams(a,o,e),a="",u=0,p=!0);else if(r===l)if(p)if(0===u){for(a={what:"optional",dependOnParams:[],parts:this._parsePattern(a,!0)},o.push(a),n=0,i=a.parts.length;i>n;++n)a.parts[n]&&"param"===a.parts[n].what&&a.dependOnParams.push(a.parts[n].name);a="",p=!1}else--u,a+=r;else a+=r;else a+=r;return this._parseParams(a,o,e),o},t.prototype._parseParams=function(t,e,r){var n,i,o,a,s=t.match(m);if(s)for(n=0,i=s.length;i>n;++n)o=s[n],o.charAt(0)===f&&o.charAt(o.length-1)===h?(a=o.substr(1,o.length-2),this._paramsMap.push(a),this._mainParamsMap[a]=!0,r||this._requiredParams.push(a),e.push({what:"param",name:a})):e.push(o)},t.prototype._buildParseRegExp=function(){this._parseRegExpSource="^"+this._buildParseRegExpParts(this._parts)+"$",this._parseRegExp=new RegExp(this._parseRegExpSource)},t.prototype._buildParseRegExpParts=function(t){var e,r,n,i="";for(e=0,r=t.length;r>e;++e)n=t[e],i+="string"==typeof n?u(n):"param"===n.what?"("+(this._getParamValueRegExpSource(n.name)||_)+")":"(?:"+this._buildParseRegExpParts(n.parts)+")?";return i},t.prototype._getParamValueRegExpSource=function(t){var e,r,n=this._conditionRegExpSources||(this._conditionRegExpSources={}),o=this._conditions;return i(n,t)||(i(o,t)?(r=o[t],e=a(r)?"(?:"+r.join("|")+")":r+""):e=null,n[t]=e),n[t]},t.prototype._getParamValueRegExp=function(t){var e,r=this._conditionRegExps||(this._conditionRegExps={});return i(r,t)||(e=this._getParamValueRegExpSource(t),r[t]=e?new RegExp("^"+e+"$"):null),r[t]},t.prototype._checkParamValue=function(t,e){var r=this._getParamValueRegExp(t);return r?r.test(e):!0},t.prototype._buildBuildFn=function(){this._buildFnSource="var h=({}).hasOwnProperty;return "+this._buildBuildFnParts(this._parts)+";",this._buildFn=new Function("p",this._buildFnSource)},t.prototype._buildBuildFnParts=function(t){var e,r,n,o,a,s,p='""',f=this._options.defaults;for(e=0,r=t.length;r>e;++e)if(a=t[e],"string"==typeof a)p+='+"'+u(a)+'"';else if("param"===a.what)this._mainParamsMap[a.name]=!0,p+='+(h.call(p,"'+u(a.name)+'")?'+'p["'+u(a.name)+'"]:'+(f&&i(f,a.name)?'"'+u(f[a.name])+'"':'""')+")";else{for(p+="+((false",n=0,o=a.dependOnParams.length;o>n;++n)s=a.dependOnParams[n],p+='||(h.call(p,"'+u(s)+'")'+(f&&i(f,s)?'&&p["'+u(s)+'"]!=="'+u(f[s])+'"':"")+")";p+=")?("+this._buildBuildFnParts(a.parts)+'):"")'}return p},t.prototype._isDataMatched=function(t){var e,r=this._options.data;if("function"==typeof t)return Boolean(t(r));if(t&&"object"==typeof t)for(e in t)if(i(t,e)&&(!r||"object"!=typeof r||r[e]!==t[e]))return!1;return!0},t.prototype.match=function(t,e){var r,n,o,u,p,f,h,c=null,l=this._options,d=l.postMatch,_=l.defaults;if("string"!=typeof t||e&&!this._isDataMatched(e))return c;if(r=t.match(this._parseRegExp)){for(c={},n=1,o=r.length;o>n;++n)if("undefined"!=typeof r[n]&&""!==r[n])if(u=this._paramsMap[n-1],u===b)h=r[n];else if(u===g){if(t.charAt(t.length-2)===y)return null}else c[u]=r[n];if(h&&l.useQueryString!==!1){f=s.parse(h);for(u in f)if(i(f,u)&&!i(c,u))if(p=f[u],this._mainParamsMap[u]&&a(p)&&(p=p[0]),a(p))for(c[u]=[],n=0,o=p.length;o>n;++n)this._checkParamValue(u,p[n])&&c[u].push(p[n]);else this._checkParamValue(u,p)&&(c[u]=p)}for(u in _)i(_,u)&&!i(c,u)&&(c[u]=_[u])}return c&&"function"==typeof d&&(c=d(c),c&&"object"==typeof c||(c=null)),c},t.prototype.build=function(t,e){var r,n,o,a,u,p=this._options,f={},h=p.useQueryString!==!1,c={},l=p.preBuild;"function"==typeof l&&(t=l(t));for(n in t)if(i(t,n)&&null!==t[n]&&"undefined"!=typeof t[n]&&(this._mainParamsMap[n]||h)){if(o=t[n],e&&!this._checkParamValue(n,o))return null;(this._mainParamsMap[n]?f:c)[n]=o}if(e)for(a=0,u=this._requiredParams.length;u>a;++a)if(!i(f,this._requiredParams[a]))return null;return h&&(r=s.stringify(c),r&&(f[b]=r)),this._buildFn(f)},t.prototype.getData=function(){return this._options.data},t.prototype.getName=function(){return this._options.name},r.exports=t,r.exports},"./router":function(){function t(){return this instanceof t?(this._routes=[],this._routesByName={},void 0):new t}var r={},n=e("./route");return t.prototype.addRoute=function(t){var e,r;return e=new n(t),this._routes.push(e),r=e.getName(),r&&(this._routesByName[r]=e),e},t.prototype.find=function(){var t,e,r,n=[],i=this._routes;for(e=0,r=i.length;r>e;++e)t=i[e].match.apply(i[e],arguments),null!==t&&n.push([i[e],t]);return n},t.prototype.findFirst=function(){var t,e,r,n=this._routes;for(e=0,r=n.length;r>e;++e)if(t=n[e].match.apply(n[e],arguments),null!==t)return[n[e],t];return null},t.prototype.getRouteByName=function(t){return this._routesByName[t]||null},t.Route=n,r.exports=t,r.exports}}[t]()}var r=e("./router"),n=!0;t.module&&"object"==typeof module.exports&&(module.exports=r,n=!1),t.modules&&modules.define&&modules.require&&(modules.define("susanin",function(t){t(r)}),n=!1),"function"==typeof t.define&&define.amd&&(define(function(){return r}),n=!1),n&&(t.Susanin=r)}(this);