!function(t){function e(t){return{"./querystring":function(){var t={},e=Object.prototype.hasOwnProperty,r=Object.prototype.toString,n=function(t){return"[object Array]"===r.call(t)},i={decode:function(t){var e;try{e=decodeURIComponent(t.replace(/\+/g,"%20"))}catch(r){e=t}return e},parse:function(t,r,o){var a,s,p,u,f,h,c,l={};if("string"!=typeof t||""===t)return l;for(r||(r="&"),o||(o="="),a=t.split(r),u=0,f=a.length;f>u;++u)h=i.decode(a[u]),c=h.indexOf(o),c>=0?(p=h.substr(0,c),s=h.substr(c+1)):(p=h,s=""),e.call(l,p)?n(l[p])?l[p].push(s):l[p]=[l[p],s]:l[p]=s;return l},stringify:function(t,r,n){var i,o,a,s,p,u,f="";if(!t)return f;r||(r="&"),n||(n="=");for(u in t)if(e.call(t,u))for(a=[].concat(t[u]),s=0,p=a.length;p>s;++s)o=typeof a[s],i="object"===o||"undefined"===o?"":encodeURIComponent(a[s]),f+=r+encodeURIComponent(u)+n+i;return f.substr(r.length)}};return t.exports=i,t.exports},"./route":function(){function t(e){if(!(this instanceof t))return new t(e);if("string"==typeof e&&(e={pattern:e}),!e||"object"!=typeof e)throw new Error("You must specify options");if("string"!=typeof e.pattern)throw new Error("You must specify the pattern of the route");this._options=e,this._conditions=e.conditions&&"object"==typeof e.conditions?e.conditions:{},e.isTrailingSlashOptional!==!1&&(e.pattern+=c+f+g+h+l,this._conditions[g]=P),e.pattern+=c+"?"+f+b+h+l,this._conditions[b]=".*",this._paramsMap=[],this._mainParamsMap={},this._requiredParams=[],this._parts=this._parsePattern(e.pattern),this._buildParseRegExp(),this._buildBuildFn()}var r={},n=Object.prototype.hasOwnProperty,i=function(t,e){return n.call(t,e)},o=Object.prototype.toString,a=function(t){return"[object Array]"===o.call(t)},s=e("./querystring"),p=function(){var t=["/",".","*","+","?","|","(",")","[","]","{","}","\\"],e=new RegExp("(\\"+t.join("|\\")+")","g");return function(t){return t.replace(e,"\\$1")}}(),u=String(Math.random()).substr(2,5),f="<",h=">",c="(",l=")",d="[a-zA-Z_][\\w\\-]*",m="[\\w\\-\\.~]+",_=new RegExp("("+p(f)+d+p(h)+"|"+"[^"+p(f)+p(h)+"]+"+"|"+p(f)+"|"+p(h)+")","g"),g="ts_"+u,y="/",P=p("/"),b="qs_"+u;return t.prototype._parsePattern=function(t,e){for(var r,n,i,o,a=[],s="",p=0,u=0,f=!1,h=t.length;h>p;)if(r=t.charAt(p++),r===c)f?(++u,s+=r):(this._parseParams(s,a,e),s="",u=0,f=!0);else if(r===l)if(f)if(0===u){for(s={what:"optional",dependOnParams:[],parts:this._parsePattern(s,!0)},a.push(s),n=0,i=s.parts.length;i>n;++n)o=s.parts[n]&&s.parts[n].what,"param"===o?s.dependOnParams.push(s.parts[n].name):"optional"===o&&s.dependOnParams.push.apply(s.dependOnParams,s.parts[n].dependOnParams);s="",f=!1}else--u,s+=r;else s+=r;else s+=r;return this._parseParams(s,a,e),a},t.prototype._parseParams=function(t,e,r){var n,i,o,a,s=t.match(_);if(s)for(n=0,i=s.length;i>n;++n)o=s[n],o.charAt(0)===f&&o.charAt(o.length-1)===h?(a=o.substr(1,o.length-2),this._paramsMap.push(a),this._mainParamsMap[a]=!0,r||this._requiredParams.push(a),e.push({what:"param",name:a})):e.push(o)},t.prototype._buildParseRegExp=function(){this._parseRegExpSource="^"+this._buildParseRegExpParts(this._parts)+"$",this._parseRegExp=new RegExp(this._parseRegExpSource)},t.prototype._buildParseRegExpParts=function(t){var e,r,n,i="";for(e=0,r=t.length;r>e;++e)n=t[e],i+="string"==typeof n?p(n):"param"===n.what?"("+(this._getParamValueRegExpSource(n.name)||m)+")":"(?:"+this._buildParseRegExpParts(n.parts)+")?";return i},t.prototype._getParamValueRegExpSource=function(t){var e,r,n=this._conditionRegExpSources||(this._conditionRegExpSources={}),o=this._conditions;return i(n,t)||(i(o,t)?(r=o[t],e=a(r)?"(?:"+r.join("|")+")":r+""):e=null,n[t]=e),n[t]},t.prototype._getParamValueRegExp=function(t){var e,r=this._conditionRegExps||(this._conditionRegExps={});return i(r,t)||(e=this._getParamValueRegExpSource(t),r[t]=e?new RegExp("^"+e+"$"):null),r[t]},t.prototype._checkParamValue=function(t,e){var r=this._getParamValueRegExp(t);return r?r.test(e):!0},t.prototype._buildBuildFn=function(){this._buildFnSource="var h=({}).hasOwnProperty;return "+this._buildBuildFnParts(this._parts)+";",this._buildFn=new Function("p",this._buildFnSource)},t.prototype._buildBuildFnParts=function(t){var e,r,n,o,a,s,u='""',f=this._options.defaults;for(e=0,r=t.length;r>e;++e)if(a=t[e],"string"==typeof a)u+='+"'+p(a)+'"';else if("param"===a.what)this._mainParamsMap[a.name]=!0,u+='+(h.call(p,"'+p(a.name)+'")?'+'p["'+p(a.name)+'"]:'+(f&&i(f,a.name)?'"'+p(f[a.name])+'"':'""')+")";else{for(u+="+((false",n=0,o=a.dependOnParams.length;o>n;++n)s=a.dependOnParams[n],u+='||(h.call(p,"'+p(s)+'")'+(f&&i(f,s)?'&&p["'+p(s)+'"]!=="'+p(f[s])+'"':"")+")";u+=")?("+this._buildBuildFnParts(a.parts)+'):"")'}return u},t.prototype._isDataMatched=function(t){var e,r=this._options.data;if("function"==typeof t)return Boolean(t(r));if(t&&"object"==typeof t)for(e in t)if(i(t,e)&&(!r||"object"!=typeof r||r[e]!==t[e]))return!1;return!0},t.prototype.match=function(t,e){var r,n,o,p,u,f,h,c=null,l=this._options,d=l.postMatch,m=l.defaults;if("string"!=typeof t||e&&!this._isDataMatched(e))return c;if(r=t.match(this._parseRegExp)){for(c={},n=1,o=r.length;o>n;++n)if("undefined"!=typeof r[n]&&""!==r[n])if(p=this._paramsMap[n-1],p===b)h=r[n];else if(p===g){if(t.charAt(t.length-2)===y)return null}else c[p]=r[n];if(h&&l.useQueryString!==!1){f=s.parse(h);for(p in f)if(i(f,p)&&!i(c,p))if(u=f[p],this._mainParamsMap[p]&&a(u)&&(u=u[0]),a(u))for(c[p]=[],n=0,o=u.length;o>n;++n)this._checkParamValue(p,u[n])&&c[p].push(u[n]);else this._checkParamValue(p,u)&&(c[p]=u)}for(p in m)i(m,p)&&!i(c,p)&&(c[p]=m[p])}return c&&"function"==typeof d&&(c=d(c),c&&"object"==typeof c||(c=null)),c},t.prototype.build=function(t,e){var r,n,o,a,p,u=this._options,f={},h=u.useQueryString!==!1,c={},l=u.preBuild;"function"==typeof l&&(t=l(t));for(n in t)if(i(t,n)&&null!==t[n]&&"undefined"!=typeof t[n]&&(this._mainParamsMap[n]||h)){if(o=t[n],e&&!this._checkParamValue(n,o))return null;(this._mainParamsMap[n]?f:c)[n]=o}if(e)for(a=0,p=this._requiredParams.length;p>a;++a)if(!i(f,this._requiredParams[a]))return null;return h&&(r=s.stringify(c),r&&(f[b]=r)),this._buildFn(f)},t.prototype.getData=function(){return this._options.data},t.prototype.getName=function(){return this._options.name},r.exports=t,r.exports},"./router":function(){function t(){return this instanceof t?(this._routes=[],this._routesByName={},void 0):new t}var r={},n=e("./route");return t.prototype.addRoute=function(t){var e,r;return e=new n(t),this._routes.push(e),r=e.getName(),r&&(this._routesByName[r]=e),e},t.prototype.find=function(){var t,e,r,n=[],i=this._routes;for(e=0,r=i.length;r>e;++e)t=i[e].match.apply(i[e],arguments),null!==t&&n.push([i[e],t]);return n},t.prototype.findFirst=function(){var t,e,r,n=this._routes;for(e=0,r=n.length;r>e;++e)if(t=n[e].match.apply(n[e],arguments),null!==t)return[n[e],t];return null},t.prototype.getRouteByName=function(t){return this._routesByName[t]||null},t.Route=n,r.exports=t,r.exports}}[t]()}var r=e("./router"),n=!0;"object"==typeof exports&&"string"!=typeof exports.nodeName&&(module.exports=r,n=!1),t.modules&&modules.define&&modules.require&&(modules.define("susanin",function(t){t(r)}),n=!1),"function"==typeof t.define&&define.amd&&(define(function(){return r}),n=!1),n&&(t.Susanin=r)}(this);