!function(t){function e(t){return{"./querystring":function(){var t={},e=Object.prototype.hasOwnProperty,r=Object.prototype.toString,n=function(t){return"[object Array]"===r.call(t)},o={decode:function(t){var e;try{e=decodeURIComponent(t.replace(/\+/g,"%20"))}catch(r){e=t}return e},parse:function(t,r,a){var i,s,p,u,f,h,l={};if("string"!=typeof t||""===t)return l;for(r||(r="&"),a||(a="="),i=t.split(r),f=0,h=i.length;h>f;++f)s=i[f].split(a),p="undefined"!=typeof s[1]?o.decode(s[1]):"",u=o.decode(s[0]),e.call(l,u)?n(l[u])?l[u].push(p):l[u]=[l[u],p]:l[u]=p;return l},stringify:function(t,r,n){var o,a,i,s,p,u,f="";if(!t)return f;r||(r="&"),n||(n="=");for(u in t)if(e.call(t,u))for(i=[].concat(t[u]),s=0,p=i.length;p>s;++s)a=typeof i[s],o="object"===a||"undefined"===a?"":encodeURIComponent(i[s]),f+=r+encodeURIComponent(u)+n+o;return f.substr(r.length)}};return t.exports=o,t.exports},"./route":function(){function t(e){if(!(this instanceof t))return new t(e);if("string"==typeof e&&(e={pattern:e}),!e||"object"!=typeof e)throw new Error("You must specify options");if("string"!=typeof e.pattern)throw new Error("You must specify the pattern of the route");this._options=e,e.conditions&&"object"==typeof e.conditions||(e.conditions={}),e.defaults&&"object"==typeof e.defaults||(e.defaults={}),e.data&&"object"==typeof e.data||(e.data={}),"string"==typeof e.name&&(e.data.name=e.name),e.isTrailingSlashOptional!==!1&&(e.pattern+=l+f+_+h+c,e.conditions[_]=b),e.pattern+=l+"?"+f+P+h+c,e.conditions[P]=".*",this._parts=this._parsePattern(e.pattern),this._buildParseRegExp(),this._buildBuildFn()}var r={},n=Object.prototype.hasOwnProperty,o=function(t,e){return n.call(t,e)},a=Object.prototype.toString,i=function(t){return"[object Array]"===a.call(t)},s=e("./querystring"),p=function(){var t=["/",".","*","+","?","|","(",")","[","]","{","}","\\"],e=new RegExp("(\\"+t.join("|\\")+")","g");return function(t){return t.replace(e,"\\$1")}}(),u=String(Math.random()).substr(2,5),f="<",h=">",l="(",c=")",d="[a-zA-Z_][\\w\\-]*",y="[\\w\\-]+",g=new RegExp("("+p(f)+d+p(h)+"|"+"[^"+p(f)+p(h)+"]+"+"|"+p(f)+"|"+p(h)+")","g"),_="ts_"+u,m="/",b=p("/"),P="qs_"+u;return t.prototype._parsePattern=function(t){for(var e,r,n,o=[],a="",i=0,s=0,p=!1,u=t.length;u>i;)if(e=t.charAt(i++),e===l)p?(++s,a+=e):(this._parseParams(a,o),a="",s=0,p=!0);else if(e===c)if(p)if(0===s){for(a={what:"optional",dependOnParams:[],parts:this._parsePattern(a)},o.push(a),r=0,n=a.parts.length;n>r;++r)a.parts[r]&&"param"===a.parts[r].what&&a.dependOnParams.push(a.parts[r].name);a="",p=!1}else--s,a+=e;else a+=e;else a+=e;return this._parseParams(a,o),o},t.prototype._parseParams=function(t,e){var r,n,o,a=t.match(g);if(a)for(r=0,n=a.length;n>r;++r)o=a[r],o.charAt(0)===f&&o.charAt(o.length-1)===h?e.push({what:"param",name:o.substr(1,o.length-2)}):e.push(o)},t.prototype._buildParseRegExp=function(){this._paramsMap=[],this._parseRegExpSource="^"+this._buildParseRegExpParts(this._parts)+"$",this._parseRegExp=new RegExp(this._parseRegExpSource)},t.prototype._buildParseRegExpParts=function(t){var e,r,n,o="";for(e=0,r=t.length;r>e;++e)n=t[e],"string"==typeof n?o+=p(n):n&&"param"===n.what?(this._paramsMap.push(n.name),o+="("+this._buildParamValueRegExpSource(n.name)+")"):n&&"optional"===n.what&&(o+="(?:"+this._buildParseRegExpParts(n.parts)+")?");return o},t.prototype._buildParamValueRegExpSource=function(t){var e,r=this._options.conditions[t];return e=r?i(r)?"(?:"+r.join("|")+")":r+"":y},t.prototype._buildBuildFn=function(){this._buildFnSource="var h=({}).hasOwnProperty;return "+this._buildBuildFnParts(this._parts)+";",this._buildFn=new Function("p",this._buildFnSource)},t.prototype._buildBuildFnParts=function(t){var e,r,n,a,i,s,u='""',f=this._options.defaults;for(e=0,r=t.length;r>e;++e)if(i=t[e],"string"==typeof i)u+='+"'+p(i)+'"';else if(i&&"param"===i.what)u+='+(h.call(p,"'+p(i.name)+'")?'+'p["'+p(i.name)+'"]:'+(o(f,i.name)?'"'+p(f[i.name])+'"':'""')+")";else if(i&&"optional"===i.what){for(u+="+((false",n=0,a=i.dependOnParams.length;a>n;++n)s=i.dependOnParams[n],u+='||(h.call(p,"'+p(s)+'")'+(o(f,s)?'&&p["'+p(s)+'"]!=="'+p(f[s])+'"':"")+")";u+=")?("+this._buildBuildFnParts(i.parts)+'):"")'}return u},t.prototype.match=function(t){var e,r,n,a,i,p,u=null,f=this._options,h=f.postMatch,l=f.defaults;if("string"==typeof t)t={path:t};else if(!t)return u;for(i in t)if(o(t,i)&&"path"!==i&&f.data[i]!==t[i])return u;if("string"==typeof t.path){if(r=t.path.match(this._parseRegExp)){for(u={},n=1,a=r.length;a>n;++n)if("undefined"!=typeof r[n]&&""!==r[n])if(e=this._paramsMap[n-1],e!==_)u[e]=r[n];else if(t.path.charAt(t.path.length-2)===m)return null;for(i in l)o(l,i)&&!o(u,i)&&(u[i]=l[i]);p=s.parse(u[P]);for(i in p)o(p,i)&&!o(u,i)&&(u[i]=p[i]);delete u[P]}}else u={};return u&&"function"==typeof h&&(u=h(u),u&&"object"==typeof u||(u=null)),u},t.prototype.build=function(t){var e,r,n,a,i,p={},u={},f=this._options.preBuild;"function"==typeof f&&(t=f(t));for(r in t)if(o(t,r)&&null!==t[r]&&"undefined"!=typeof t[r]){for(n=!1,a=0,i=this._paramsMap.length;i>a;++a)if(this._paramsMap[a]===r){n=!0;break}n?p[r]=t[r]:u[r]=t[r]}return e=s.stringify(u),e&&(p[P]=e),this._buildFn(p)},t.prototype.getData=function(){return this._options.data},t.prototype.getName=function(){return this._options.data.name},r.exports=t,r.exports},"./router":function(){function t(){return this instanceof t?(this._routes=[],this._routesByName={},void 0):new t}var r={},n=e("./route");return t.prototype.addRoute=function(t){var e,r;return e=new n(t),this._routes.push(e),r=e.getName(),r&&(this._routesByName[r]=e),e},t.prototype.find=function(t){var e,r,n,o=[],a=this._routes;for(r=0,n=a.length;n>r;++r)e=a[r].match(t),null!==e&&o.push([a[r],e]);return o},t.prototype.findFirst=function(t){var e,r,n,o=this._routes;for(r=0,n=o.length;n>r;++r)if(e=o[r].match(t),null!==e)return[o[r],e];return null},t.prototype.getRouteByName=function(t){return this._routesByName[t]||null},t.Route=n,r.exports=t,r.exports}}[t]()}t.Susanin=e("./router")}(this);